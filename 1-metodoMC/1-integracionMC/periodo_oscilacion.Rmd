---
title: "Periodo de oscilacion del pendulo"
output: html_notebook
params:
  longitud_hilo: 
    label: "Longitud del hilo (en metros)"
    value: 1
    min: 0.1
    step: 0.1
  aceleracion_gravedad:
    label: "Aceleracion de la gravidad (en metros por segundo al cuadrado)"
    input: slider
    value: !r round (pi/4, digits = 2)
    min: 0
    max: !r round(pi, digits = 2)
    step: 0.01
  amplitud: 0.79
---

```{r reproducibilidad}
set.seed(4205687)
```

Definimos las constantes que aparecen en las expresiones
```{r }
constante_integral <- 2*pi*sqrt(params$longitud_hilo/params$aceleracion_gravedad)

sin_2_mitad_amplitud <- sin(params$amplitud/2)^2
```


Aplicamos el metodo de Montecarlo para estimar el periodo del pendulo
```{r generacion}
genera_valor_aleatorio <- function(){
  runif(1)
}

g <- function(u){
  1/sqrt(1-sin_2_mitad_amplitud*sin(pi/2*u)^2)
}
```

```{r replicacion}
n <- 1e5
valores <- replicate(n, {
  u <- genera_valor_aleatorio()
  g(u)
})
```

```{r estimacion}
estimacion_T <- constante_integral*mean(valores)

probabilidad_cobertura <- 0.95
alfa <- 1 - probabilidad_cobertura
percentil <- qnorm(1-alfa/2)

error_estandar <- constante_integral*sqrt(var(valores)/n)

interval_confianza <- estimacion_T + c(-1,1)*error_estandar*percentil
```

En un lugar donde la aceleracion de la gravedad es \(`r params$aceleracion_gravedad` m/s^2\), el valor estimado para la oscilacion del pendulo que cuelga de un hilo de longitud \( `r params$longitud_hilo`\) metro cuando se deja caer desde una amplitud de \(`r params$amplitud`\) radiantes es \(`r estimacion_T`\), siendo \( `r interval_confianza`\) un intervalo de confianza con probabilidad de cobertura \(`r probabilidad_cobertura`\)
