---
title: "Paradaoja San Peterbugo"
output: html_document

---

```{r replicabilidad}
set.seed(938475)
```

```{r}
estimacion_MC <- function(){
  n <- 1e5
  valores <- replicate(n, {
    x <- rgeom(1, prob = 1/2)
    2^(x+1)
  })
  Estimacion <- mean(valores)
  
  probabilidad_cobertura <- 0.95
  alfa <- 1 - probabilidad_cobertura
  percentil <- qnorm(1 - alfa / 2)
  error_estandar <- sqrt(var(valores) / n)
  
  Intervalo <- Estimacion + c(-1, 1) * error_estandar * percentil
  Longitud <- diff(Intervalo)
  
  Estimacion
  Intervalo
  Longitud
}

estimacion_MC()
```
La esperanza no esiste

```{r}
library(ggplot2)

n <- 1e5
  valores <- replicate(n, {
    x <- rgeom(1, prob = 1/2)
    2^(x+1)
  })
  
ggplot(
  data.frame(x = 1:n, 
             y = cumsum(valores)/(1:n)),
  aes(x = x, y = y)
) + geom_line()
```

